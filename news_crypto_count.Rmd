---
title: "News crypto occurence"
output: html_document
---
```{r}
#install.packages("tidyverse")
#install.packages("jsonlite")
#install.packages("stringr")
```
First available news :      2013-08-01 18:30:00
```{r}
rm(list=ls()) 
library(tidyverse)
library(jsonlite)
library(stringr)
library(lubridate)
```

#Getting the whole CryptoNewsData set 
This dataset stores all the news articles about cryptocurrencies released from 2013-08-01 18:30:00 that CryptoCompare API proposes

Here we download the dataset and store it to a csv file with dl_data_news function
```{r}
#data <- dl_data_from(as.numeric(as.POSIXct("2013-11-25 1:00:00 EST")))
#write.csv(data, "CryptonewsData.csv")
```

#Analysing the dataset for plots data
We load the dataset from csv for rapidity 
```{r}
data <- read.csv("data/CryptonewsData.csv")[-1]
```

We want to analyse the occurences of the 20 most capitalized cryptocurrencies; so we download the list of these cryptocurrencies symbols using get_imp_Crp function.
Here we removed some the 20 currencies that were not available in our crypto dictionary.
```{r}
#interesting_crypto <- get_imp_Crp()[-c(8,13,15,16)]
interesting_crypto <- c("")
```

Now we can analyse the news dataset based on the cryptocurencies we chose with analyse_crps_news function.
```{r}
result <- analyse_crps_news(data, interesting_crypto)
```

Finally; we sum the occurences of each cryptocurrency per hour and per day for plotting; using the functions resTspToHour and resTspToDay.
We then write them in csvs file to create the two datasets CryptoNewsOccurencesHour and CryptoNewsOccurencesDay
```{r}
finalHour <- resTspToHour(result, interesting_crypto)
write.csv(finalHour, "CryptoNewsOccurencesHour.csv")

finalDay <- resTspToDay(result, interesting_crypto)
write.csv(finalDay, "CryptoNewsOccurencesDays.csv")
```

To make sure these datasets stay up to date for live usage, we can update them with the following functions:

```{r}
updateHourNewsData()
```

```{r}
updateDayNewsData()
```
```{r}
dataNews <- read.csv("data/CryptoNewsOccurencesHour.csv")
```


