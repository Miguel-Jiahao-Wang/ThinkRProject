---
title: "News crypto occurence"
output: html_document
---
```{r}
library(tidyverse)
```

```{r cars}
Tsp_data <- function(timestamp) {
  link <- paste("https://min-api.cryptocompare.com/data/v2/news/?lTs=", timestamp, sep="")
  data <- fromJSON(link)
  data2 <- data.frame("time" = data$Data$published_on, "body" = data$Data$body)
  return(data2)
}


time <- 1543089648 # now
timelimit <- 1514764800	#1st jan 2018
data <- Tsp_data(time)
time <- min(data$time)


```

```{r}
time <- min(data$time)
timelimit <- 1514764800	#1st jan 2018
while (time > timelimit)
{
  new_data <- Tsp_data(time)
  time <- min(new_data$time)
  data <- rbind(data,new_data)
}
```

```{r}
data %>% slice(1:10) %>% mutate(crypto = ifelse( grepl(c("ETH","Ethereum"), body, ignore.case = TRUE), 1, 0) )

data %>% slice(1:10) %>% mutate(BTC = ifelse(sum(grepl(c("ETH","Ethereum"), body, ignore.case = TRUE))>0, 1, 0) )
```
