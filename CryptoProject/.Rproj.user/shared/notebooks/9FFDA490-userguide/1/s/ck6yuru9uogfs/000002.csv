"0","day_hour <- function(timeframe, firstDay, lastDay, crytocurrenty = ""BTC"", comparison = ""USD"") {"
"0","  library(dplyr)"
"0","  library(jsonlite)"
"0","  # Date"
"0","  firstDay <- as.Date(firstDay,format=""%d/%m/%Y"")"
"0","  lastDay <- as.Date(lastDay,format=""%d/%m/%Y"")"
"0","  time <- round(as.numeric(as.POSIXct(lastDay, format=""%m/%d/%Y"")))"
"0","  # Number of points of hour dataframe"
"0","  n <- as.numeric(lastDay-firstDay)"
"0","  if (timeframe %in% c(""Day"", ""day"")){"
"0","    a <- ""histoday"""
"0","    incr <- 3600*24"
"0","  }"
"0","  else if (timeframe %in% c(""Hour"", ""hour"")) {"
"0","    a <- ""histohour"""
"0","    n <- round(n*24)"
"0","    incr <- 3600"
"0","  }"
"0","  else {"
"0","    print('No valid timeframe')"
"0","    return();"
"0","  }"
"0","  # Maximum number of points is 2000"
"0","  if (n <= 2000) {"
"0","    link <- paste(""https://min-api.cryptocompare.com/data/"", a,""?fsym="",crytocurrenty, ""&tsym="", comparison,""&limit="", n, ""&aggregate=1&toTs="",time, ""&extraParams=ThinkR"", sep = """")"
"0","    linkVolume <- paste(""https://min-api.cryptocompare.com/data/exchange/"", a,""?tsym="",crytocurrenty,""&limit="", n, ""&toTs="",time, ""&extraParams=ThinkR"", sep = """")"
"0","    dataPrice <- fromJSON(link)"
"0","    dataVolume <- fromJSON(linkVolume)"
"0","    df <- data.frame("
"0","      date= as.POSIXct(dataPrice$Data$time,origin = ""1970-01-01"",tz = ""GMT""),"
"0","      high=dataPrice$Data$high,"
"0","      low = dataPrice$Data$low,"
"0","      open = dataPrice$Data$open,"
"0","      close = dataPrice$Data$close,"
"0","      volume = dataVolume$Data$volume"
"0","    )"
"0","  }"
"0","  # If the number of points is higher than the maximum we need to do a for loop"
"0","  else {"
"0","    # Round to the highest Integuer"
"0","    iterations <- ceiling(n/2000)"
"0","    n1 <- 2000"
"0","    for (i in 1:iterations){"
"0","      if (i ==iterations){"
"0","        n1 =n-2000*(iterations-1)"
"0","      }"
"0","      linkPrice <- paste(""https://min-api.cryptocompare.com/data/"", a,""?fsym="",crytocurrenty, ""&tsym="", comparison,""&limit="", n1, ""&aggregate=1&toTs="",time, ""&extraParams=ThinkR"", sep = """")"
"0","      linkVolume <- paste(""https://min-api.cryptocompare.com/data/exchange/"", a,""?tsym="",crytocurrenty,""&limit="", n1, ""&toTs="",time, ""&extraParams=ThinkR"", sep = """")"
"0","      dataPrice <- fromJSON(linkPrice)"
"0","      dataVolume <- fromJSON(linkVolume)"
"0","      df1 <- data.frame("
"0","        date= as.POSIXct(dataPrice$Data$time,origin = ""1970-01-01"",tz = ""GMT""),"
"0","        high=dataPrice$Data$high,"
"0","        low = dataPrice$Data$low,"
"0","        open = dataPrice$Data$open,"
"0","        close = dataPrice$Data$close,"
"0","        volume = dataVolume$Data$volume"
"0","      )"
"0","      if (i ==1){"
"0","        df <- df1"
"0","      } else {"
"0","        df <- rbind(df, df1)"
"0","      }"
"0","      time <- time - 2000*incr"
"0","    }"
"0","  }"
"0","  df <-df %>%"
"0","  mutate(direction = ifelse(open >close, ""increasing"", ""decreasing"")) %>%"
"0","  arrange(date)"
"0","  return(df)"
"0","}"
